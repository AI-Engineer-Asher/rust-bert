use std::path::Path;
use tract_onnx::prelude::*;
fn main() -> anyhow::Result<()> {
    let model_path = Path::new("E:/Coding/nli-distilroberta-base/model_optimized.onnx");

    let model = onnx().model_for_path(model_path)?.into_runnable()?;

    let input_ids: Vec<i64> = vec![
        0, 10285, 186, 38, 7084, 127, 6894, 1732, 8, 655, 187, 172, 127, 1028, 34, 57, 27169, 1295,
        8378, 38, 304, 110, 1553, 4, 2, 2, 713, 2788, 16, 59, 1830, 4, 2, 1, 0, 10285, 186, 38,
        7084, 127, 6894, 1732, 8, 655, 187, 172, 127, 1028, 34, 57, 27169, 1295, 8378, 38, 304,
        110, 1553, 4, 2, 2, 713, 2788, 16, 59, 998, 4, 2, 1, 0, 10285, 186, 38, 7084, 127, 6894,
        1732, 8, 655, 187, 172, 127, 1028, 34, 57, 27169, 1295, 8378, 38, 304, 110, 1553, 4, 2, 2,
        713, 2788, 16, 59, 19892, 4, 2, 1, 0, 10285, 186, 38, 7084, 127, 6894, 1732, 8, 655, 187,
        172, 127, 1028, 34, 57, 27169, 1295, 8378, 38, 304, 110, 1553, 4, 2, 2, 713, 2788, 16, 59,
        1316, 899, 4, 2,
    ];
    let attention: Vec<i64> = vec![
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    ];

    let input_ids = tract_ndarray::Array2::from_shape_vec((4, 34), input_ids)?.into();
    let attention_mask = tract_ndarray::Array2::from_shape_vec((4, 34), attention)?.into();

    let result = model.run(tvec!(input_ids, attention_mask))?;

    println!("{:?}", result);

    Ok(())
}
